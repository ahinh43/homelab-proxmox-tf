#cloud-config
users:
  - name: debian
    primary_group: sudo
    sudo: ALL=(ALL) NOPASSWD:ALL
    shell: /bin/bash
    ssh-authorized-keys:
      - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCknK37QKXdA4PYpZMIuHMraGjqDOXaNtMmIZI4FBhd2Z0GmtVvIpYwwNm3lR/eEZ4/6mV1OcOgt/eV7wccCBXEFxQNA2j7amh5JBH11SpLxFRw2YOiRpPK9/w1ontGgI0MXrhuxxnkIhx7V8NvpcqX3FVP2wHhq5REXa6USuT8thgEuhC+aP26a5Upx7qR2k+WsOEmfW/XoMXEqac156eBP79EuR6xxBitKNfgQqI1VFq1uutg26zWdwbUBjTqg0mZ308suCbMfMDnJ0wzVuJrm7kzoEJWWcwUNBVXa/Kwc9yHPxGIszjZeLl16klxp5KBjmJsN4fTny++EDeYylDL ahinh43@github/33781835
      - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC2PhL297eW7+AEBekvgcXu0ikumqbu2eIr+TfOj++92hTNo7rFTX4hYjr9n31+j1vTkHYQxqg7XMFEdF3HNFB1Bg9dLJBOVgDHC/WDF94HbN4DuKwfmZN8YZ6Ev8XRidBZvfbfxbHk9gVbEFhl6vB3NlTLG8X6XPF+zycXOffQGNyf731Fh89eLl0yobusTD72F+4T0BUhgRrCrvy08EWaAovDuOcyHh2jfITK+jlPzn6QibSxFCy1JDztAtzZS5YcBhOhayxkWoQb4kw033wciI2KSP841ZCQM1uEFm1/9i2VgRGA4ry8gNdFwr7l6Z09NG6Q7wbg6DXhcjYPGWeJlkLkGa6txeM9dH9IbhlfIPAnNHxGCG+iwvavNjgPAv0q23qIb3K13zPhd8nzYWf1X/BIUtrGrn7LIxgxkw6B3kHn5mzaEBaZk2k3jAAGZkwM7/7ThQAEJ94lVyHyNzoS6kJqk6bW3pGxxpXTnQGhNWeCrFj+RmG93gKbW6a5Yr0= ahinh43@github/84668115
      - ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIBFZ6pd5qmAhRH0pJlSO5Bq0+r1D/PzsXyX4jNg12KRQ
  - name: minecraft
    primary_group: sudo
    sudo: ALL=(ALL) NOPASSWD:ALL
    shell: /bin/bash
    ssh-authorized-keys:
      - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCknK37QKXdA4PYpZMIuHMraGjqDOXaNtMmIZI4FBhd2Z0GmtVvIpYwwNm3lR/eEZ4/6mV1OcOgt/eV7wccCBXEFxQNA2j7amh5JBH11SpLxFRw2YOiRpPK9/w1ontGgI0MXrhuxxnkIhx7V8NvpcqX3FVP2wHhq5REXa6USuT8thgEuhC+aP26a5Upx7qR2k+WsOEmfW/XoMXEqac156eBP79EuR6xxBitKNfgQqI1VFq1uutg26zWdwbUBjTqg0mZ308suCbMfMDnJ0wzVuJrm7kzoEJWWcwUNBVXa/Kwc9yHPxGIszjZeLl16klxp5KBjmJsN4fTny++EDeYylDL ahinh43@github/33781835
      - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC2PhL297eW7+AEBekvgcXu0ikumqbu2eIr+TfOj++92hTNo7rFTX4hYjr9n31+j1vTkHYQxqg7XMFEdF3HNFB1Bg9dLJBOVgDHC/WDF94HbN4DuKwfmZN8YZ6Ev8XRidBZvfbfxbHk9gVbEFhl6vB3NlTLG8X6XPF+zycXOffQGNyf731Fh89eLl0yobusTD72F+4T0BUhgRrCrvy08EWaAovDuOcyHh2jfITK+jlPzn6QibSxFCy1JDztAtzZS5YcBhOhayxkWoQb4kw033wciI2KSP841ZCQM1uEFm1/9i2VgRGA4ry8gNdFwr7l6Z09NG6Q7wbg6DXhcjYPGWeJlkLkGa6txeM9dH9IbhlfIPAnNHxGCG+iwvavNjgPAv0q23qIb3K13zPhd8nzYWf1X/BIUtrGrn7LIxgxkw6B3kHn5mzaEBaZk2k3jAAGZkwM7/7ThQAEJ94lVyHyNzoS6kJqk6bW3pGxxpXTnQGhNWeCrFj+RmG93gKbW6a5Yr0= ahinh43@github/84668115
      - ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIBFZ6pd5qmAhRH0pJlSO5Bq0+r1D/PzsXyX4jNg12KRQ
apt:
  sources_list: |
    deb $MIRROR $RELEASE main contrib non-free non-free-firmware
    deb-src $MIRROR $RELEASE main contrib non-free non-free-firmware
    deb $SECURITY $RELEASE-securityE main contrib non-free non-free-firmware
    deb-src $SECURITY $RELEASE-security main contrib non-free non-free-firmware
hostname: cap10mc.labs.ahinh.me
ssh_pwauth: False
disable_root: false
package_update: true
package_upgrade: true
packages:
  - dnsutils
  - htop
  - jq
  - tmux
  - unattended-upgrades
  - awscli
  - cron
  - prometheus-node-exporter
  - net-tools

# This happens before the user creation
# so the files are owned by root first to prevent username not found errors
write_files:
  - path: /root/install-minecraft.sh
    owner: root:root
    permissions: "0755"
    encoding: b64
    content: IyEvdXNyL2Jpbi9lbnYgYmFzaAoKIyBUaGlzIHNjcmlwdCBpbnN0YWxscyB0aGUgbmVlZGVkIHNjcmlwdHMgYW5kIHRvb2xzIGZvciBhIE1pbmVjcmFmdCBzZXJ2ZXIgcnVubmluZyBvbiBKYXZhCgpqcmV2ZXJzaW9uPSIkMSIKanJlbWlubWVtPSIkMiIKanJlbWF4bWVtPSIkMyIKdHlwZT0iJDQiCnZlcnNpb249IiQ1IgphcHQtZ2V0IHVwZGF0ZQphcHQtZ2V0IHVwZ3JhZGUgLXkKCiMgSW5zdGFsbHMgYmFzZSBwYWNrYWdlcyBuZWVkZWQKCmFwdC1nZXQgaW5zdGFsbCAteSBcCiAgdG11eCBcCiAgb3Blbmpkay0iJGpyZXZlcnNpb24iLWpyZS1oZWFkbGVzcyBcCiAgcHl0aG9uMy1waXAKCnBpcDMgaW5zdGFsbCAtVSByZXF1ZXN0cyBmaXJlCgojIENyZWF0ZXMgdGhlIG1pbmVjcmFmdCB1c2VyIGFuZCB0aGUgbWluZWNyYWZ0IGRpcmVjdG9yeSBmb3IgbWluZWNyYWZ0IGluc3RhbGxhdGlvbnMKCm1rZGlyIC1wIC9taW5lY3JhZnQKCiMgQ3JlYXRlcyB0aGUgZXVsYS50eHQgZmlsZSB3aGljaCBpcyBuZWVkZWQgaW4gYWxsIE1pbmVjcmFmdCBzZXJ2ZXJzCgpjYXQgPDxFT0YgfCB0ZWUgL21pbmVjcmFmdC9ldWxhLnR4dAojQnkgY2hhbmdpbmcgdGhlIHNldHRpbmcgYmVsb3cgdG8gVFJVRSB5b3UgYXJlIGluZGljYXRpbmcgeW91ciBhZ3JlZW1lbnQgdG8gb3VyIEVVTEEgKGh0dHBzOi8vYWNjb3VudC5tb2phbmcuY29tL2RvY3VtZW50cy9taW5lY3JhZnRfZXVsYSkuCiNUaHUgQXVnIDA4IDAwOjAwOjAwIFVUQyAyMDIyCmV1bGE9dHJ1ZQpFT0YKCiMgQ3JlYXRlcyB0aGUgYmFzZSB3aGl0ZWxpc3QganNvbiB3aGljaCBpbmNsdWRlcyB1c2VycyB3aG8gYXJlIGFsbG93ZWQgb250byB0aGUgc2VydmVyIGJ5IGRlZmF1bHQKCmNhdCA8PEVPRiB8IHRlZSAvbWluZWNyYWZ0L3doaXRlbGlzdC5qc29uClsKICB7CiAgICAidXVpZCI6ICJhZjQxOGNlNy01M2Q0LTQyNTItYTRiMy1jODViYzM0MWYwMTQiLAogICAgIm5hbWUiOiAiS0ZDQ29sb25lbCIKICB9Cl0KRU9GCgojIENyZWF0ZXMgdGhlIGJhc2Ugb3AganNvbiBmaWxlIHdoaWNoIHNldHMgdGhlIGRlc2lyZWQgdXNlcnMgYXMgc2VydmVyIG92ZXJsb3JkcwoKY2F0IDw8RU9GIHwgdGVlIC9taW5lY3JhZnQvb3BzLmpzb24KWwogIHsKICAgICJ1dWlkIjogImFmNDE4Y2U3LTUzZDQtNDI1Mi1hNGIzLWM4NWJjMzQxZjAxNCIsCiAgICAibmFtZSI6ICJLRkNDb2xvbmVsIiwKICAgICJsZXZlbCI6IDQsCiAgICAiYnlwYXNzZXNQbGF5ZXJMaW1pdCI6IGZhbHNlCiAgfQpdCkVPRgoKIyBDcmVhdGVzIHRoZSBzeXN0ZW1kIHNlcnZpY2UgZmlsZSB1c2VkIHRvIHN0YXJ0IGFuZCBzdG9wIG1pbmVjcmFmdCBzZXJ2ZXJzIHVzaW5nIHRtdXgKCmNhdCA8PEVPRiB8IHRlZSAvZXRjL3N5c3RlbWQvc3lzdGVtL21pbmVjcmFmdC5zZXJ2aWNlCltVbml0XQpEZXNjcmlwdGlvbj1NaW5lY3JhZnQgU2VydmVyCgpbU2VydmljZV0KV29ya2luZ0RpcmVjdG9yeT0vbWluZWNyYWZ0ClVzZXI9bWluZWNyYWZ0ClR5cGU9Zm9ya2luZwpSZXN0YXJ0PWFsd2F5cwoKRXhlY1N0YXJ0PS91c3IvYmluL3RtdXggbmV3LXNlc3Npb24gLXMgbWMtJWkgLWQgJy9taW5lY3JhZnQvc3RhcnQtc2VydmVyLnNoJwpFeGVjU3RvcD0vdXNyL2Jpbi90bXV4IHNlbmQta2V5cyAtdCBtYy0laTowLjAgJ3NheSBTRVJWRVIgU0hVVFRJTkcgRE9XTi4gU2F2aW5nIG1hcC4uLicgQy1tICdzYXZlLWFsbCcgQy1tICdzdG9wJyBDLW0KRXhlY1N0b3A9L2Jpbi9zbGVlcCAyCgpbSW5zdGFsbF0KV2FudGVkQnk9bXVsdGktdXNlci50YXJnZXQKRU9GCgojIFJlbG9hZCB0aGUgc3lzdGVtZCBkYWVtb24Kc3lzdGVtY3RsIGRhZW1vbi1yZWxvYWQKCgojIFVuZm9ydHVuYXRlbHkgZWFjaCBtaW5lY3JhZnQgc2VydmVyIChlc3BlY2lhbGx5IG1vZHBhY2tzKSBoYXZlIGNvbXBsZXRlbHkgZGlmZmVyZW50IHdheXMgdG8gZ28gYWJvdXQgaW5zdGFsbGluZyB0aGUgc2VydmVyIHBhY2thZ2VzIChpLmUgZm9yZ2UgdnMgdmFuaWxsYSwgcGFwZXJtYyB2cyBzcGlnb3QsIGV0Yy4pCiMgV2UnbGwgdHJ5IHRvIGluc3RhbGwgYSBiYXNlIGlmIHBvc3NpYmxlLiBJZiB0eXBlIGlzIG5vdCBzZXQsIGxlYXZlIGJsYW5rCgojIEluc3RhbGxzIHBhcGVybWMgZm9yIHZhbmlsbGEuIFRoZSB2YW5pbGxhIHZhbmlsbGEgbWluZWNyYWZ0IGphciBpcyBwcmV0dHkgYmFkIGltbwppZiBbICIkdHlwZSIgPT0gInZhbmlsbGEiIF07IHRoZW4KICBidWlsZD0iJChjdXJsIGh0dHBzOi8vcGFwZXJtYy5pby9hcGkvdjIvcHJvamVjdHMvcGFwZXIvdmVyc2lvbnMvJHZlcnNpb24vYnVpbGRzIHwganEgLXIgJy5idWlsZHNbLTFdLmJ1aWxkJykiCiAgd2dldCAtTyBwYXBlci5qYXIgImh0dHBzOi8vcGFwZXJtYy5pby9hcGkvdjIvcHJvamVjdHMvcGFwZXIvdmVyc2lvbnMvJHZlcnNpb24vYnVpbGRzLyRidWlsZC9kb3dubG9hZHMvcGFwZXItJHZlcnNpb24tJGJ1aWxkLmphciIKICBtdiBwYXBlci5qYXIgL21pbmVjcmFmdC9taW5lY3JhZnQtc2VydmVyLmphcgogICMgU3RhcnQgYW5kIHN0b3AgdGhlIHNlcnZlciB0byBnZW5lcmF0ZSB0aGUgc2VydmVyIHByb3BlcnR5IGZpbGVzIGFuZCB3aGF0bm90CiAgY2QgL21pbmVjcmFmdAogIHByaW50ZiAiJXMiICJzdG9wIiB8IGphdmEgLWphciBtaW5lY3JhZnQtc2VydmVyLmphcgogIAogICMgUHJlIGNvbmZpZ3VyZSB0aGUgc2VydmVyIHByb3BlcnRpZXMgZmlsZQogIHNlZCAtaSAncy9tb3RkPS4qL21vdGQ9TkVFRUVFRUVFRUVFRUVFRUVFRUVFRUUvZycgc2VydmVyLnByb3BlcnRpZXMKICBzZWQgLWkgJ3MvZW5hYmxlLWNvbW1hbmQtYmxvY2s9ZmFsc2UvZW5hYmxlLWNvbW1hbmQtYmxvY2s9dHJ1ZS9nJyBzZXJ2ZXIucHJvcGVydGllcwogIHNlZCAtaSAncy93aGl0ZS1saXN0PWZhbHNlL3doaXRlLWxpc3Q9dHJ1ZS9nJyBzZXJ2ZXIucHJvcGVydGllcwogIHNlZCAtaSAncy9hbGxvdy1mbGlnaHQ9ZmFsc2UvYWxsb3ctZmxpZ2h0PXRydWUvZycgc2VydmVyLnByb3BlcnRpZXMKICBzZWQgLWkgJ3MvZW5mb3JjZS13aGl0ZWxpc3Q9ZmFsc2UvZW5mb3JjZS13aGl0ZWxpc3Q9dHJ1ZS9nJyBzZXJ2ZXIucHJvcGVydGllcwogIHNlZCAtaSAncy9kaWZmaWN1bHR5PS4qL2RpZmZpY3VsdHk9bm9ybWFsL2cnIHNlcnZlci5wcm9wZXJ0aWVzCgogICMgRGVwZW5kaW5nIG9uIHdoYXQgc2VydmVyIHZlcnNpb24gaXMgdXNlZCwgbW9kaWZ5IHRoZSBqYXZhIGFyZ3VtZW50cwogIGlmIFsgIiRqcmV2ZXJzaW9uIiA9ICI4IiBdOyB0aGVuCiAgICBjYXQgPDxFT0YgfCB0ZWUgL21pbmVjcmFmdC9zdGFydC1zZXJ2ZXIuc2gKICAgICMhL3Vzci9iaW4vZW52IGJhc2gKICAgIC91c3IvYmluL2phdmEgLWphciAtWFg6K1VzZUcxR0MgLVhteCR7anJlbWF4bWVtfUcgLVhtcyR7anJlbWlubWVtfUcgLURmbWwucmVhZFRpbWVvdXQ9MTIwIC1Ec3VuLnJtaS5kZ2Muc2VydmVyLmdjSW50ZXJ2YWw9MjE0NzQ4MzY0NiAtWFg6K1VubG9ja0V4cGVyaW1lbnRhbFZNT3B0aW9ucyAtWFg6RzFOZXdTaXplUGVyY2VudD0yMCAtWFg6RzFSZXNlcnZlUGVyY2VudD0yMCAtWFg6TWF4R0NQYXVzZU1pbGxpcz01MCAtWFg6RzFIZWFwUmVnaW9uU2l6ZT0zMk0gbWluZWNyYWZ0LXNlcnZlci5qYXIKRU9GCiAgZWxzZQogICAgY2F0IDw8RU9GIHwgdGVlIC9taW5lY3JhZnQvc3RhcnQtc2VydmVyLnNoCiAgICAjIS91c3IvYmluL2VudiBiYXNoCiAgICAvdXNyL2Jpbi9qYXZhIC1YWDorVXNlRzFHQyAtWFg6K1BhcmFsbGVsUmVmUHJvY0VuYWJsZWQgLVhYOk1heEdDUGF1c2VNaWxsaXM9MjAwIC1YWDorVW5sb2NrRXhwZXJpbWVudGFsVk1PcHRpb25zIC1YWDorRGlzYWJsZUV4cGxpY2l0R0MgLVhYOitBbHdheXNQcmVUb3VjaCAtWFg6RzFOZXdTaXplUGVyY2VudD0zMCAtWFg6RzFNYXhOZXdTaXplUGVyY2VudD00MCAtWFg6RzFIZWFwUmVnaW9uU2l6ZT04TSAtWFg6RzFSZXNlcnZlUGVyY2VudD0yMCAtWFg6RzFIZWFwV2FzdGVQZXJjZW50PTUgLVhYOkcxTWl4ZWRHQ0NvdW50VGFyZ2V0PTQgLVhYOkluaXRpYXRpbmdIZWFwT2NjdXBhbmN5UGVyY2VudD0xNSAtWFg6RzFNaXhlZEdDTGl2ZVRocmVzaG9sZFBlcmNlbnQ9OTAgLVhYOkcxUlNldFVwZGF0aW5nUGF1c2VUaW1lUGVyY2VudD01IC1YWDpTdXJ2aXZvclJhdGlvPTMyIC1YWDorUGVyZkRpc2FibGVTaGFyZWRNZW0gLVhYOk1heFRlbnVyaW5nVGhyZXNob2xkPTEgLUR1c2luZy5haWthcnMuZmxhZ3M9aHR0cHM6Ly9tY2ZsYWdzLmVtYy5ncyAtRGFpa2Fycy5uZXcuZmxhZ3M9dHJ1ZSAtRGZtbC5yZWFkVGltZW91dD0xODAgLURmbWwucXVlcnlSZXN1bHQ9Y29uZmlybSAtWG14JHtqcmVtYXhtZW19RyAtWG1zJHtqcmVtaW5tZW19RyAtamFyIG1pbmVjcmFmdC1zZXJ2ZXIuamFyCkVPRgogIGZpCmZpCgppZiBbICIkdHlwZSIgPT0gImZvcmdlIiBdOyB0aGVuCiAgZm9yZ2V1cmw9JChweXRob24zIC90bXAvZ2V0LWZvcmdlLXZlcnNpb24ucHkgLS12ZXJzaW9uPSIkdmVyc2lvbiIpCiAgd2dldCAtTyBmb3JnZS1pbnN0YWxsZXIuamFyICIkZm9yZ2V1cmwiCiAgbXYgZm9yZ2UtaW5zdGFsbGVyLmphciAvbWluZWNyYWZ0L2ZvcmdlLWluc3RhbGxlci5qYXIKICBwd2QKICBjZCAvbWluZWNyYWZ0CiAgamF2YSAtamFyIGZvcmdlLWluc3RhbGxlci5qYXIgLS1pbnN0YWxsU2VydmVyCiAgcm0gLXJmIGZvcmdlLWluc3RhbGxlci5qYXIKICBtdiAvbWluZWNyYWZ0L3J1bi5zaCAvbWluZWNyYWZ0L3N0YXJ0LXNlcnZlci5zaAoKICBlY2hvICItWG14JHtqcmVtYXhtZW19RyIgPj4gdXNlcl9qdm1fYXJncy50eHQKICBlY2hvICItWG1zJHtqcmVtaW5tZW19RyIgPj4gdXNlcl9qdm1fYXJncy50eHQKCiAgIyBTdGFydCBhbmQgc3RvcCB0aGUgc2VydmVyIHRvIGdlbmVyYXRlIHRoZSBzZXJ2ZXIgcHJvcGVydHkgZmlsZXMgYW5kIHdoYXRub3QKICBwcmludGYgIiVzIiAic3RvcCIgfCAuL3N0YXJ0LXNlcnZlci5zaAogIAogICMgUHJlIGNvbmZpZ3VyZSB0aGUgc2VydmVyIHByb3BlcnRpZXMgZmlsZQogIHNlZCAtaSAncy9tb3RkPS4qL21vdGQ9TkVFRUVFRUVFRUVFRUVFRUVFRUVFRUUvZycgc2VydmVyLnByb3BlcnRpZXMKICBzZWQgLWkgJ3MvZW5hYmxlLWNvbW1hbmQtYmxvY2s9ZmFsc2UvZW5hYmxlLWNvbW1hbmQtYmxvY2s9dHJ1ZS9nJyBzZXJ2ZXIucHJvcGVydGllcwogIHNlZCAtaSAncy93aGl0ZS1saXN0PWZhbHNlL3doaXRlLWxpc3Q9dHJ1ZS9nJyBzZXJ2ZXIucHJvcGVydGllcwogIHNlZCAtaSAncy9hbGxvdy1mbGlnaHQ9ZmFsc2UvYWxsb3ctZmxpZ2h0PXRydWUvZycgc2VydmVyLnByb3BlcnRpZXMKICBzZWQgLWkgJ3MvZW5mb3JjZS13aGl0ZWxpc3Q9ZmFsc2UvZW5mb3JjZS13aGl0ZWxpc3Q9dHJ1ZS9nJyBzZXJ2ZXIucHJvcGVydGllcwogIHNlZCAtaSAncy9kaWZmaWN1bHR5PS4qL2RpZmZpY3VsdHk9Mi9nJyBzZXJ2ZXIucHJvcGVydGllcwoKZmkKCmNobW9kICt4IC9taW5lY3JhZnQvc3RhcnQtc2VydmVyLnNoCgoKCiMgU2V0cyB0aGUgdXNlciBtaW5lY3JhZnQgdGhlIG93bmVyIG9mIGV2ZXJ5IGZpbGUKY2hvd24gLVIgbWluZWNyYWZ0OnN1ZG8gL21pbmVjcmFmdAoKIyBFbmFibGVzIHRoZSBtaW5lY3JhZnQgc2VydmljZSwgYWx0aG91Z2ggaXQgd2lsbCBiYXNpY2FsbHkgY3Jhc2ggbG9vcCB0aWxsIHRoZSBzdGFydC1zZXJ2ZXIuc2ggc2VydmVyIGNhbiBhY3R1YWxseSBzdGFydCBhIHNlcnZlcgpzeXN0ZW1jdGwgZW5hYmxlIG1pbmVjcmFmdC5zZXJ2aWNlCnN5c3RlbWN0bCBzdGFydCBtaW5lY3JhZnQ=
runcmd:
  - cp /root/install-minecraft.sh /home/minecraft/install-minecraft.sh && chown minecraft:minecraft /home/minecraft/install-minecraft.sh
